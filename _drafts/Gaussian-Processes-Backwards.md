# Gaussian Process Regression, Explained Backwards
*Scott Hawley, July 19, 2018*

### Preface
In July 2015, I very much enjoyed seeing [Yarin Gal](https://twitter.com/yaringal)'s post ["What My Deep Network Doeesn't Know,"](http://mlg.eng.cam.ac.uk/yarin/blog_3d801aa532c1ce.html) but, busy guy that I am, I read it rather quickly, played with the demos a bit, and then moved on to things like grading student papers and working on my existing machine learning project(s).

Three years later, while visiting London, I met up with [Will Wilkerson](https://twitter.com/wil_j_wil) of QMUL in London, who's using Gaussian Processes (GPs) to synthesize audio.  And I remembered reading something about those once...

Well, I'm in Oxford all July, and guess who else is in Oxford now, and is Associate Professor of Machine Learning too -- Yarin Gal!  And since he graciously agreed to chat with me, I figured I'd best 'study up' on GPs for real...

...but although there are many excellent tutorials -- including Gal's -- that strive to (or claim to) be [gentle introductions](http://dfm.io/george/dev/tutorials/first/), and not having time to read the [seminal textbook on the subject](http://www.gaussianprocess.org/gpml/chapters/RW1.pdf), what I *apparently* need is some sort of 'Gaussian Processes for Complete Morons'...  

...Because I don't want to start with matrix equations, or the definition of what is a multivariate Gaussian distribution, rather I want to start with 'what are we trying to do?'

### Starting from the Goal
Given some data points, can we make some mathematical model to fit a curve to them, and can we obtain some measure of the uncertainty in the curve fit? Or in Gal's words, *"What is a function that is likely to have generated our data?"*

In the following image from Gal's post \[spoiler: nothing in my post is original!\], we see what we might want in the end:

![GPgraph](http://mlg.eng.cam.ac.uk/yarin/blog_images/plot_uncertainty.jpg)

In the above image, the red points are the *given* data. The blue bits  show the predictions of our magical model, in two parts:

1. The solid line goes through all the given data, and ends up being the mean output of the GP system (which, sure, we haven't defined yet but we'll get there)  
2. The shaded blue regions denote the *range* of possible outputs from the model, in the form of the uncertainty.  The key thing to note is **that the uncertainty (or variance) is small near the given data, and in between the given data the uncertainty grows** (in fact, it's helpful to observe that the uncertainty reaches a maximum at the midpoint between any two given red points).  This property is sufficient to motivate what follows.  (For those wondering, "Why doesn't the uncertainty go to zero precisely *at* the red points?" You can make the model do that.  The above picture is just an example.)

Now, when we talk about uncertainties, we're talking about some kind of probability distribution, and often the simplest and most useful distribution is -- you guessed it -- gaussian. So, the model is going to combine gaussian functions using some kindad of measure of how far away a given (interpolation) point is from nearby given data points.

Conceptually, *that's it.*  But as with many things in the life of the scientist (e.g., General Relatvity), quantifying that simple, elegant concept involves  a \*\*\*\* ton of careful math. To wit...

### Recasting the Problem
First, some clarification and notation.  We'll regard the given <p align="center"><img src="/_drafts/tex/d40360a78b382eff383bb78d6f59e5e9.svg?invert_in_darkmode&sanitize=true" align=middle width=12.32879835pt height=11.232861749999998pt/></p><img src="/_drafts/tex/14f1044b791703d61d4d5d590f30346d.svg?invert_in_darkmode&sanitize=true" align=middle width=102.42160169999998pt height=22.831056599999986pt/><p align="center"><img src="/_drafts/tex/b13aa5bb3cf320c37fa5ae9cbb19145c.svg?invert_in_darkmode&sanitize=true" align=middle width=87.58570094999999pt height=16.438356pt/></p><img src="/_drafts/tex/91f03aa85ba1d031b48c73a54147df63.svg?invert_in_darkmode&sanitize=true" align=middle width=321.52469085pt height=22.831056599999986pt/><p align="center"><img src="/_drafts/tex/582995ab66b2a907d77d598f9d678619.svg?invert_in_darkmode&sanitize=true" align=middle width=12.710331149999998pt height=10.2739725pt/></p><img src="/_drafts/tex/4a1d3509e8cf88506bcf5a2eb4cbe892.svg?invert_in_darkmode&sanitize=true" align=middle width=700.2744803999999pt height=85.29681270000002pt/><p align="center"><img src="/_drafts/tex/6d023340983a22d0d820f8dd235a4a26.svg?invert_in_darkmode&sanitize=true" align=middle width=43.614813pt height=10.2739725pt/></p><img src="/_drafts/tex/da9d8f1bdc8ecae314644a7f8cc3b11a.svg?invert_in_darkmode&sanitize=true" align=middle width=33.40875284999999pt height=24.65753399999998pt/><p align="center"><img src="/_drafts/tex/5cff7ee43b456e5d924bcc17d9eb0633.svg?invert_in_darkmode&sanitize=true" align=middle width=63.24196559999999pt height=14.202794099999998pt/></p><img src="/_drafts/tex/f3720c219991c8ba61090cf59ec9c7b1.svg?invert_in_darkmode&sanitize=true" align=middle width=173.7896985pt height=24.7161288pt/><p align="center"><img src="/_drafts/tex/96de47a534893e2f93c9edceffaef3d1.svg?invert_in_darkmode&sanitize=true" align=middle width=14.045887349999997pt height=9.54335085pt/></p><img src="/_drafts/tex/569d4404dae07146007a6ff6d53fe3af.svg?invert_in_darkmode&sanitize=true" align=middle width=887.6828433pt height=24.7161288pt/><p align="center"><img src="/_drafts/tex/bb7e53a88fcae0289c8404efc541e28b.svg?invert_in_darkmode&sanitize=true" align=middle width=14.292166349999999pt height=11.27854365pt/></p><img src="/_drafts/tex/55f30cd7ff5056c4745de798b7563930.svg?invert_in_darkmode&sanitize=true" align=middle width=15.53010359999999pt height=21.68300969999999pt/><p align="center"><img src="/_drafts/tex/d546e0ee5a0604ca911ec7acb79e5a97.svg?invert_in_darkmode&sanitize=true" align=middle width=14.99998995pt height=11.232861749999998pt/></p><img src="/_drafts/tex/446d310f1a4c2c726a8edaef29c10d79.svg?invert_in_darkmode&sanitize=true" align=middle width=379.4817543pt height=22.831056599999986pt/><p align="center"><img src="/_drafts/tex/8e803306116d08082c744b5adf433429.svg?invert_in_darkmode&sanitize=true" align=middle width=14.76475935pt height=11.27854365pt/></p><img src="/_drafts/tex/4c100750143b2a547da6aa6d5b21f74a.svg?invert_in_darkmode&sanitize=true" align=middle width=183.52725435pt height=22.831056599999986pt/><p align="center"><img src="/_drafts/tex/6e576b4b8b0235f0632d20874f8f302f.svg?invert_in_darkmode&sanitize=true" align=middle width=54.62752515pt height=11.27854365pt/></p><img src="/_drafts/tex/a3a87df68cb905381f69ed2c90da15f5.svg?invert_in_darkmode&sanitize=true" align=middle width=28.842529649999985pt height=24.65753399999998pt/><p align="center"><img src="/_drafts/tex/6f797c641c2fd4d9dcb3353888ad66bb.svg?invert_in_darkmode&sanitize=true" align=middle width=73.42917285pt height=14.6502939pt/></p><img src="/_drafts/tex/03770bcaadf0351b95f2bbee050b6709.svg?invert_in_darkmode&sanitize=true" align=middle width=304.03362164999993pt height=24.65753399999998pt/><p align="center"><img src="/_drafts/tex/bb7e53a88fcae0289c8404efc541e28b.svg?invert_in_darkmode&sanitize=true" align=middle width=14.292166349999999pt height=11.27854365pt/></p><img src="/_drafts/tex/fd92a53167b3c6ae9574071613d555dc.svg?invert_in_darkmode&sanitize=true" align=middle width=27.11199479999999pt height=22.831056599999986pt/><p align="center"><img src="/_drafts/tex/8e803306116d08082c744b5adf433429.svg?invert_in_darkmode&sanitize=true" align=middle width=14.76475935pt height=11.27854365pt/></p><img src="/_drafts/tex/6201006b5509f117b0c29e00b89041b0.svg?invert_in_darkmode&sanitize=true" align=middle width=257.38280699999996pt height=22.831056599999986pt/><p align="center"><img src="/_drafts/tex/f997fd4e37c6f90fa2525df01e12021e.svg?invert_in_darkmode&sanitize=true" align=middle width=16.712310449999997pt height=12.1411488pt/></p><img src="/_drafts/tex/a51ad642c407de445628b74ad830f7c3.svg?invert_in_darkmode&sanitize=true" align=middle width=355.7744338499999pt height=22.831056599999986pt/><p align="center"><img src="/_drafts/tex/41f8b66fc2861aca10bbb1125e0a4238.svg?invert_in_darkmode&sanitize=true" align=middle width=16.97487825pt height=15.337499099999999pt/></p><img src="/_drafts/tex/5f58fc4598276008b9e89d7a31159108.svg?invert_in_darkmode&sanitize=true" align=middle width=120.75253244999999pt height=22.831056599999986pt/><img src="/_drafts/tex/8f739ca3633b078e78284aff81b66e18.svg?invert_in_darkmode&sanitize=true" align=middle width=104.62187504999999pt height=24.65753399999998pt/><img src="/_drafts/tex/4a165526e5db0cb76be59f408d2dba80.svg?invert_in_darkmode&sanitize=true" align=middle width=213.60795554999996pt height=45.84475499999998pt/><p align="center"><img src="/_drafts/tex/41f8b66fc2861aca10bbb1125e0a4238.svg?invert_in_darkmode&sanitize=true" align=middle width=16.97487825pt height=15.337499099999999pt/></p>$ is called the *predictive mean* of the model, and its variance is called the *predictive uncertainty*."

**TODO:** more later
